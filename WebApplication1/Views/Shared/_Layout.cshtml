<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - ŞikayetAI</title>

    <!-- Sayfanın önbelleğe alınmasını engellemek için meta etiketleri eklendi -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />

    <!-- Google Fonts: Montserrat (başlıklar) ve Open Sans (metinler) -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Open+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">

    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" xintegrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <!-- Custom Site CSS - Bootstrap'i geçersiz kılmak ve özel stiller eklemek için en sonda olmalı -->
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />

    <!-- SORUN GİDERME: Navbar'ın içeriğin üzerine gelmesini engellemek için -->
    <style>
        .main-header {
            position: fixed; /* Navbar'ın daima üstte kalmasını sağlar */
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1030; /* Diğer içeriklerin üstünde kalması için */
        }

        main.flex-grow-1 {
            /* Navbar'ın yüksekliği kadar boşluk bırakır. Değer navbar yüksekliğinize göre ayarlanabilir. */
            padding-top: 75px;
        }
    </style>
</head>
<body class="d-flex flex-column min-vh-100">
    <header class="main-header">
        <nav class="navbar">
            <!-- Logo ve Yazı Tıklanabilir Hale Getirildi ve class güncellendi -->
            <a asp-action="Index" asp-controller="Home" class="logo text-decoration-none">
                <i class="fas fa-lightbulb"></i> ŞikayetAI
            </a>
            <ul class="nav-links">
                <!-- Navigasyon linkleri güncellendi: Önce Ana Sayfaya git, sonra ilgili bölüme kaydır -->
                <li><a asp-action="Index" asp-controller="Home" asp-fragment="hakkimizda">Hakkımızda</a></li>
                <li><a asp-action="Index" asp-controller="Home" asp-fragment="nasil-calisir">Nasıl Çalışır?</a></li>
                <li><a asp-action="Index" asp-controller="Home" asp-fragment="ozellikler">Özellikler</a></li>

                @if (Context.Session.GetInt32("UserId") != null)
                {
                    <!-- Kullanıcı Giriş Yapmışsa: Şikayet Gönder sayfasına git -->
                    <li><a asp-action="Create" asp-controller="Complaint" class="btn-text-link">Şikayet Gönder</a></li>
                }
                else
                {
                    <!-- Kullanıcı Giriş Yapmamışsa: Giriş Yap sayfasına yönlendir -->
                    <li><a asp-action="Login" asp-controller="Auth" class="btn-text-link">Şikayet Gönder</a></li>
                }

                @if (Context.Session.GetInt32("UserId") != null)
                {
                    <!-- Kullanıcı Giriş Yapmışsa: Profil ve Çıkış Yap -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle btn btn-primary-filled" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="fas fa-user me-2"></i> Profil
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
                            <li><a class="dropdown-item" asp-action="ProfileView" asp-controller="Home"><i class="fas fa-id-card-alt me-2"></i> Profili Görüntüle</a></li>
                            <li><a class="dropdown-item" asp-action="ProfileSettings" asp-controller="Home"><i class="fas fa-user-edit me-2"></i> Profili Güncelle</a></li>
                            <li><a class="dropdown-item" asp-action="MyComplaints" asp-controller="Complaint"><i class="fas fa-list-alt me-2"></i> Şikayetlerim</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" asp-action="Logout" asp-controller="Auth"><i class="fas fa-sign-out-alt me-2"></i> Çıkış Yap</a></li>
                        </ul>
                    </li>
                }
                else
                {
                    <!-- Kullanıcı Giriş Yapmamışsa: Kayıt Ol ve Giriş Yap -->
                    <li><a asp-action="Register" asp-controller="Auth" class="btn btn-secondary-outline">Kayıt Ol</a></li>
                    <li><a asp-action="Login" asp-controller="Auth" class="btn btn-primary-filled">Giriş Yap</a></li>
                }
            </ul>
            <div class="menu-toggle" id="mobile-menu">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </nav>
    </header>

    <main role="main" class="flex-grow-1">
        @RenderBody()
    </main>

    <footer>
        <div class="container">
            <p>&copy; @DateTime.Now.Year - ŞikayetAI. Tüm Hakları Saklıdır.</p>
            <div class="social-links">
                <a href="#"><i class="fab fa-github social-icon-subtle"></i></a>
                <a href="#"><i class="fab fa-twitter social-icon-subtle delay-100"></i></a>
                <a href="#"><i class="fab fa-linkedin-in social-icon-subtle delay-200"></i></a>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS (Popper.js ile birlikte) - Dropdownlar için gerekli -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" xintegrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <!-- Particles.js JS -->
    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>

    <!-- Custom Site JS -->
    <script src="~/js/app.js" asp-append-version="true"></script>

    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>
